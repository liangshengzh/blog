title: ARP协议
date: 2017-11-08 17:50:40
tags:
 - ARP
---


ARP(Address Resolution Protocol,地址解析协议)是根据IP地址获取物理地址的一个TCP/IP协议。在通过以太网发送IP数据包时，ARP协议负责将一个已知的IP地址解析成MAC地址，以便于设备间可以进行正常的通信。

![ARP](/post_images/arp.png)

如上图所示，IP地址为192.168.1.10的主机(1)和192.168.1.11(2)的主机通信时，ARP可以将192.168.1.11的IP地址解析成该主机的MAC地址，详细过程如下：

1. 当1向发送数据给2时，首先会在自己的ARP缓存中查找与2匹配的MAC地址记录
2. 如果在缓存中没有找到对应的记录，它需要询问2的MAC地址，将ARP请求帧广播到网络中的所有主机。该帧包含了1的IP地址和MAC地址，网络中的每台主机在收到ARP协议后检查是否与自己的IP地址匹配，如果不匹配则丢弃该ARP请求。
3. 主机2确定自己的IP地址和ARP请求中IP地址匹配，则将主机1的IP地址和MAC地址添加到本地ARPC缓存表中
4. 主机2将包含自己MAC地址的ARP响应发送给主机1(单播).主机1在收主机2的ARP回复后，将2的IP和MAC地址添加到自己的ARP缓存表。本机缓存表的有效期默认为120s。
